<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#0f0f0f">
<title>RIDER TRACKER PRO V1.0</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root{--bg:#0f0f0f;--card:#1a1a1a;--primary:#00CCBC;--accent:#ff4d4d;--text:#e0e0e0;--dim:#888;--orange:#ffa500;--red-soft:#8b0000}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:sans-serif;background:var(--bg);color:var(--text);margin:0;padding:8px;padding-bottom:340px;text-align:center}
.app-title{margin:5px 0 10px;font-size:18px;font-weight:800;color:var(--primary);text-transform:uppercase}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:10px}
.card{background:var(--card);height:65px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:10px;border:1px solid #333}
.label{font-size:7px;color:var(--dim);text-transform:uppercase;margin-bottom:2px;font-weight:bold}
.val{font-size:12px;font-weight:bold}
.card.main .val,#lordo,#mancante{color:var(--primary)!important}#netto{color:var(--accent)!important}
.card input{width:85%;background:0 0;border:none;border-bottom:1px solid #444;color:#fff;text-align:center;font-size:12px;outline:0}
.progress-container{background:var(--card);padding:10px;border-radius:12px;margin-bottom:10px;border:1px solid #333}
.progress-bar{background:#222;height:18px;border-radius:6px;overflow:hidden;margin-top:6px;border:1px solid #444}
#bar{background:linear-gradient(90deg,var(--primary),#ccff00);height:100%;width:0;transition:.3s}
/* CORREZIONE SOVRAPPOSIZIONE MODIFICA 68 */
.live-clock-box{margin:10px 0 20px;padding:8px;border-radius:10px;border:1px solid #333;background:var(--card);box-shadow:0 4px 8px rgba(0,0,0,0.5)}
#liveClock{color:var(--primary);font-size:16px;font-weight:900;font-family:monospace}
#liveDate{color:var(--dim);font-size:9px;text-transform:uppercase;margin-bottom:2px}
.sticky-footer{position:fixed;bottom:0;left:0;right:0;background:#161616;padding:15px 10px 25px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;border-top:1px solid #333;z-index:1000}
.foot-btn{background:#222;border:1px solid #444;color:#fff;padding:12px 5px;border-radius:12px;display:flex;flex-direction:column;align-items:center;font-size:10px;font-weight:700}
.foot-btn i{font-size:18px;color:var(--primary);margin-bottom:4px}
.btn-full{grid-column:span 3;background:var(--primary);color:#000;padding:15px;border-radius:12px;font-weight:900;border:none;font-size:12px;text-transform:uppercase;margin-top:5px}
.btn-reset-soft{grid-column:span 3;background:var(--red-soft);color:#ccc;border:none;padding:10px;border-radius:10px;font-weight:700;font-size:9px;margin-top:8px;text-transform:uppercase}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.95);z-index:9999;padding:20px}
.modal-content{background:var(--card);padding:20px;border-radius:20px;width:100%;max-width:400px;border:2px solid var(--primary);margin:20px auto}
.modal input{width:100%;padding:12px;background:#252525;border:1px solid #444;color:#fff;border-radius:10px;margin-bottom:10px;font-size:16px}
.date-row{display:flex;gap:5px;margin-bottom:10px}.date-row select{background:#333;color:#fff;padding:10px;border-radius:8px;flex:1;border:1px solid #444}
.btn-modal{width:100%;padding:14px;border-radius:10px;border:none;font-weight:700;margin-top:8px}.btn-save{background:var(--primary);color:#000}.btn-close{background:#333;color:#fff}
</style>
</head>
<body>
<div class="app-title">RIDER TRACKER PRO V1.0</div>
<div class="grid">
<div class="card main"><span class="label">LORDO</span><span class="val">€<span id="lordo">0.00</span></span></div>
<div class="card main"><span class="label">NETTO</span><span class="val" id="netto">€0.00</span></div>
<div class="card"><span class="label">ORE</span><span class="val" id="ore">0.0</span></div>
<div class="card"><span class="label">LITRI STIM.</span><span class="val" id="cons">0.0L</span></div>
<div class="card"><span class="label">KM/L</span><span class="val" id="kml">0.0</span></div>
<div class="card"><span class="label">SPESA BENZ.</span><span class="val" id="spesaB">€0.00</span></div>
<div class="card"><span class="label">TARGET €</span><input type="number" id="targetIn" oninput="aggiornaTarget()"></div>
<div class="card"><span class="label">TAX %</span><input type="number" id="taxIn" oninput="aggiornaTax()"></div>
<div class="card"><span class="label">MANCANTE</span><span class="val" id="mancante">€0.00</span></div>
</div>
<div class="progress-container">
<div style="display:flex;justify-content:space-between;font-weight:700;color:var(--primary);font-size:10px"><span>OBIETTIVO</span><span id="perc">0%</span></div>
<div class="progress-bar"><div id="bar"></div></div>
</div>
<div class="live-clock-box"><div id="liveDate">--/--/----</div><div id="liveClock">00:00:00</div></div>
<div id="modalTurno" class="modal"><div class="modal-content"><h3>Nuovo Turno</h3><div id="dateT" class="date-row"></div><input type="number" id="tL" placeholder="Lordo (€)" step="0.01"><input type="number" id="tO" placeholder="Ore lavorate" step="0.1"><input type="number" id="tK" placeholder="Chilometri percorsi"><input type="number" id="tC" placeholder="Consumo L/100km"><button class="btn-modal btn-save" onclick="salvaTurno()">SALVA</button><button class="btn-modal btn-close" onclick="chiudiModali()">CHIUDI</button></div></div>
<div id="modalBenza" class="modal"><div class="modal-content" style="border-color:var(--orange)"><h3>Rifornimento</h3><div id="dateB" class="date-row"></div><input type="number" id="bE" placeholder="Euro spesi (€)" step="0.01"><input type="number" id="bP" placeholder="Prezzo (€/L)" step=".001"><button class="btn-modal btn-save" style="background:var(--orange)" onclick="salvaBenza()">SALVA</button><button class="btn-modal btn-close" onclick="chiudiModali()">CHIUDI</button></div></div>
<div id="histView" style="display:none;position:fixed;inset:0;z-index:8000;background:var(--bg);padding:15px;overflow-y:auto"><h2 style="color:var(--primary)">STORICO</h2><div id="listaStorico"></div><button class="btn-modal btn-close" onclick="document.getElementById('histView').style.display='none'">CHIUDI</button></div>
<div class="sticky-footer">
<div class="foot-btn" onclick="apriM('modalTurno')"><i class="fas fa-plus-circle"></i>TURNO</div>
<div class="foot-btn" onclick="apriM('modalBenza')"><i class="fas fa-gas-pump"></i>BENZINA</div>
<div class="foot-btn" onclick="apriStorico()"><i class="fas fa-history"></i>STORICO</div>
<button class="btn-full" onclick="apriReport()">REPORT PDF</button>
<button class="btn-reset-soft" onclick="confirm('AZZERARE?')&&(localStorage.clear(),location.reload())">AZZERA DATABASE</button>
</div>
<script>
let db=JSON.parse(localStorage.getItem('rider_db_final_v30'))||{turni:[],rifornimenti:[],targets:{},tax:20};
function startClock(){setInterval(()=>{const e=new Date,t=e.toLocaleDateString('it-IT',{weekday:'short',day:'2-digit',month:'short'}),a=e.toLocaleTimeString('it-IT');document.getElementById('liveDate').innerText=t,document.getElementById('liveClock').innerText=a},1e3)}
function salvaDB(){localStorage.setItem('rider_db_final_v30',JSON.stringify(db)),calcola()}
function chiudiModali(){document.querySelectorAll('.modal').forEach(e=>e.style.display='none')}
function calcola(){const e=new Date,t=`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`;let a=db.turni.filter(e=>e.data.includes(t)),r=db.rifornimenti.filter(e=>e.data.includes(t)),n=a.reduce((e,t)=>e+t.lordo,0),l=a.reduce((e,t)=>e+t.ore,0),o=a.reduce((e,t)=>e+t.km,0),i=a.reduce((e,t)=>e+t.km*(t.cons/100),0),s=r.reduce((e,t)=>e+t.euro,0),d=r.length>0?r[r.length-1].prezzo:1.85,c=n-(n*(db.tax/100))-i*d;document.getElementById('lordo').innerText=n.toFixed(2),document.getElementById('netto').innerText='€'+c.toFixed(2),document.getElementById('ore').innerText=l.toFixed(1),document.getElementById('cons').innerText=i.toFixed(1)+'L',document.getElementById('kml').innerText=i>0?(o/i).toFixed(1):'0.0',document.getElementById('spesaB').innerText='€'+s.toFixed(2);let g=db.targets[t]||0;document.getElementById('targetIn').value=g||"";document.getElementById('taxIn').value=db.tax;let m=g-n;document.getElementById('mancante').innerText='€'+(m>0?m.toFixed(2):"0.00");let u=g>0?Math.min(n/g*100,100):0;document.getElementById('perc').innerText=Math.round(u)+'%',document.getElementById('bar').style.width=u+'%'}
function apriM(e){const t=new Date;let a="",r="",n="";for(let e=1;e<=31;e++)a+=`<option value="${e}" ${e==t.getDate()?"selected":""}>${e}</option>`;const m=["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"];m.forEach((e,a)=>r+=`<option value="${a+1}" ${a==t.getMonth()?"selected":""}>${e}</option>`);for(let e=2025;e<=2026;e++)n+=`<option value="${e}" ${e==t.getFullYear()?"selected":""}>${e}</option>`;const l="modalTurno"===e?"dateT":"dateB";document.getElementById(l).innerHTML=`<select id="${l}D">${a}</select><select id="${l}M">${r}</select><select id="${l}Y">${n}</select>`,document.getElementById(e).style.display='block'}
function salvaTurno(){const e=`${document.getElementById('dateTD').value.padStart(2,"0")}/${document.getElementById('dateTM').value.padStart(2,"0")}/${document.getElementById('dateTY').value}`;db.turni.push({id:Date.now(),data:e,lordo:parseFloat(document.getElementById('tL').value)||0,ore:parseFloat(document.getElementById('tO').value)||0,km:parseFloat(document.getElementById('tK').value)||0,cons:parseFloat(document.getElementById('tC').value)||0}),salvaDB(),chiudiModali()}
function salvaBenza(){const e=`${document.getElementById('dateBD').value.padStart(2,"0")}/${document.getElementById('dateBM').value.padStart(2,"0")}/${document.getElementById('dateBY').value}`;db.rifornimenti.push({id:Date.now(),data:e,euro:parseFloat(document.getElementById('bE').value)||0,prezzo:parseFloat(document.getElementById('bP').value)||0}),salvaDB(),chiudiModali()}
function aggiornaTarget(){const e=`${((new Date).getMonth()+1).toString().padStart(2,"0")}/${(new Date).getFullYear()}`;db.targets[e]=parseFloat(document.getElementById('targetIn').value)||0,salvaDB()}
function aggiornaTax(){db.tax=parseFloat(document.getElementById('taxIn').value)||20,salvaDB()}
window.onload=()=>{calcola(),startClock()};
</script>
</body>
</html>
