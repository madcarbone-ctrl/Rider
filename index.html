<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#0f0f0f">
<title>RIDER TRACKER PRO V1.0</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root{--bg:#0f0f0f;--card:#1a1a1a;--primary:#00CCBC;--accent:#ff4d4d;--text:#e0e0e0;--dim:#888;--input-bg:#252525;--orange:#ffa500;--red-soft:#8b0000}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:sans-serif;background:var(--bg);color:var(--text);margin:0;padding:10px;padding-bottom:380px;text-align:center}
.app-title{margin:10px 0 15px;font-size:22px;font-weight:800;color:var(--primary);text-transform:uppercase;user-select:none}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:15px}
.card{background:var(--card);height:75px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:12px;border:1px solid #333}
.label{font-size:8px;color:var(--dim);text-transform:uppercase;margin-bottom:4px;font-weight:bold}
.val{font-size:14px;font-weight:bold}
.card.main .val,#lordo,#mancante{color:var(--primary)!important}#netto{color:var(--accent)!important}
.card input{width:80%;background:0 0;border:none;border-bottom:1px solid #444;color:#fff;text-align:center;font-size:14px;outline:0}
.progress-container{background:var(--card);padding:15px;border-radius:15px;margin-bottom:10px;border:1px solid #333}
.progress-bar{background:#222;height:25px;border-radius:8px;overflow:hidden;margin-top:10px;border:1px solid #444}
#bar{background:linear-gradient(90deg,var(--primary),#ccff00);height:100%;width:0;transition:.3s}
.live-clock-box{margin:20px 0;padding:15px;border-radius:15px;border:1px solid #333;background:var(--card);box-shadow:0 4px 10px rgba(0,0,0,0.3)}
#liveClock{color:var(--primary);font-size:20px;font-weight:900;letter-spacing:1px;font-family:monospace}
#liveDate{color:var(--dim);font-size:10px;text-transform:uppercase;font-weight:700;margin-bottom:5px}
.storico-item{background:#0f0f0f;padding:15px 5px;border-top:1px solid #333;border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}
.storico-item::before{content:"[";color:#444;font-size:35px;font-weight:100;margin-right:5px}.storico-item::after{content:"]";color:#444;font-size:35px;font-weight:100;margin-left:5px}
.storico-info{flex:1;text-align:left;padding:0 10px}.tipo-label{font-size:9px;font-weight:900;text-transform:uppercase;letter-spacing:1.5px}
.storico-main{font-size:18px;font-weight:700}.storico-sub{font-size:10px;color:var(--dim)}
#reportView{display:none;position:fixed;inset:0;z-index:8000;background:#fff;color:#000;padding:20px;overflow-y:auto;text-align:left}
.report-header-mini{border-bottom:2px solid #000;padding-bottom:5px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:baseline}
.report-header-mini h2{font-size:14px;margin:0;text-transform:uppercase}.report-header-mini span{font-size:10px;font-weight:700}
.report-table{width:100%;border-collapse:collapse;font-size:9px;margin-bottom:15px}.report-table td,.report-table th{border:1px solid #000;padding:4px;text-align:center}.report-table th{background:#eee}
.summary-box{border:2px solid #000;padding:10px;background:#fff}.summary-row{display:flex;justify-content:space-between;padding:3px 0;border-bottom:1px dashed #000;font-size:11px}
.summary-row.total{font-weight:700;font-size:14px;border-top:2px solid #000;margin-top:5px;border-bottom:none}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.95);z-index:9999;overflow-y:auto;padding:20px}
.modal-content{background:var(--card);padding:25px;border-radius:24px;width:100%;max-width:400px;border:2px solid var(--primary);margin:30px auto}
.modal input{width:100%;padding:14px;background:var(--input-bg);border:1px solid #444;color:#fff;border-radius:12px;margin-bottom:12px;outline:0;font-size:16px}
.date-row{display:flex;gap:8px;margin-bottom:15px}.date-row select{background:#333;color:#fff;padding:12px;border-radius:10px;flex:1;border:1px solid #444}
.btn-modal{width:100%;padding:16px;border-radius:12px;border:none;font-weight:700;margin-top:10px;font-size:16px}.btn-save{background:var(--primary);color:#000}.btn-close{background:#333;color:#fff}
.sticky-footer{position:fixed;bottom:15px;left:10px;right:10px;background:#161616;padding:20px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;border-radius:25px;border:1px solid #333;z-index:1000}
.foot-btn{background:#222;border:1px solid #444;color:#fff;padding:15px 5px;border-radius:15px;display:flex;flex-direction:column;align-items:center;font-size:11px;font-weight:700}
.foot-btn i{font-size:22px;color:var(--primary);margin-bottom:6px}.btn-full{grid-column:span 3;background:var(--primary);color:#000;padding:18px;border-radius:15px;font-weight:900;border:none;font-size:14px;text-transform:uppercase;margin-top:5px}
.btn-reset-soft{grid-column:span 3;background:var(--red-soft);color:#ccc;border:none;padding:12px;border-radius:12px;font-weight:700;font-size:11px;margin-top:10px;text-transform:uppercase;letter-spacing:1px}
@media print{body *{visibility:hidden}#reportView,#reportView *{visibility:visible}#reportView{position:absolute;left:0;top:0;width:100%;display:block!important}}
</style>
</head>
<body>
<div class="app-title no-print">RIDER TRACKER PRO V1.0</div>
<div class="grid no-print">
<div class="card main"><span class="label">LORDO</span><span class="val">€<span id="lordo">0.00</span></span></div>
<div class="card main"><span class="label">NETTO</span><span class="val" id="netto">€0.00</span></div>
<div class="card"><span class="label">ORE</span><span class="val" id="ore">0.0</span></div>
<div class="card"><span class="label">LITRI STIM.</span><span class="val" id="cons">0.0L</span></div>
<div class="card"><span class="label">KM/L</span><span class="val" id="kml">0.0</span></div>
<div class="card"><span class="label">SPESA BENZ.</span><span class="val" id="spesaB">€0.00</span></div>
<div class="card"><span class="label">TARGET €</span><input type="number" id="targetIn" oninput="aggiornaTarget()"></div>
<div class="card"><span class="label">TAX %</span><input type="number" id="taxIn" oninput="aggiornaTax()"></div>
<div class="card"><span class="label">MANCANTE</span><span class="val" id="mancante">€0.00</span></div>
</div>
<div class="progress-container no-print">
<div style="display:flex;justify-content:space-between;font-weight:700;color:var(--primary);font-size:12px"><span>OBIETTIVO</span><span id="perc">0%</span></div>
<div class="progress-bar"><div id="bar"></div></div>
</div>
<div class="live-clock-box no-print"><div id="liveDate">--/--/----</div><div id="liveClock">00:00:00</div></div>
<div id="modalTurno" class="modal no-print"><div class="modal-content"><h3>Nuovo Turno</h3><div id="dateT" class="date-row"></div><input type="number" id="tL" placeholder="Lordo (€)" step="0.01"><input type="number" id="tO" placeholder="Ore lavorate" step="0.1"><input type="number" id="tK" placeholder="Chilometri percorsi"><input type="number" id="tC" placeholder="Consumo L/100km"><button class="btn-modal btn-save" onclick="salvaTurno()">SALVA TURNO</button><button class="btn-modal btn-close" onclick="chiudiModali()">ANNULLA</button></div></div>
<div id="modalBenza" class="modal no-print"><div class="modal-content" style="border-color:var(--orange)"><h3>Rifornimento</h3><div id="dateB" class="date-row"></div><input type="number" id="bE" placeholder="Euro spesi (€)" step="0.01"><input type="number" id="bP" placeholder="Prezzo (€/L)" step=".001"><button class="btn-modal btn-save" style="background:var(--orange)" onclick="salvaBenza()">SALVA BENZINA</button><button class="btn-modal btn-close" onclick="chiudiModali()">ANNULLA</button></div></div>
<div id="histView" class="no-print" style="display:none;position:fixed;inset:0;z-index:8000;background:var(--bg);padding:15px;overflow-y:auto"><h2 style="color:var(--primary);text-align:center">STORICO</h2><div id="listaStorico"></div><button class="btn-modal btn-close" onclick="document.getElementById('histView').style.display='none'">CHIUDI</button></div>
<div id="reportView"><div class="report-header-mini"><h2 id="repMonthTitle">REPORT</h2><span>RIDER TRACKER PRO V1.0</span></div><div class="report-section"><h3>DETTAGLIO TURNI</h3><table class="report-table"><thead><tr><th>DATA</th><th>LORDO</th><th>ORE</th><th>KM</th><th>L/100</th><th>LITRI</th></tr></thead><tbody id="repTurniBody"></tbody></table></div><div class="report-section"><h3>DETTAGLIO RIFORNIMENTI</h3><table class="report-table"><thead><tr><th>DATA</th><th>SPESA</th><th>PREZZO/L</th><th>LITRI</th></tr></thead><tbody id="repBenzaBody"></tbody></table></div><div class="report-section"><h3>ANALISI E RIEPILOGO FINALE</h3><div class="summary-box" id="repFinalSummary"></div></div><div class="no-print" style="display:flex;gap:10px;margin-top:20px"><button class="btn-modal btn-save" style="background:#000;color:#fff" onclick="window.print()">STAMPA PDF</button><button class="btn-modal btn-close" onclick="document.getElementById('reportView').style.display='none'">CHIUDI</button></div></div>
<div class="sticky-footer no-print">
<div class="foot-btn" onclick="apriM('modalTurno')"><i class="fas fa-plus-circle"></i>TURNO</div>
<div class="foot-btn" onclick="apriM('modalBenza')"><i class="fas fa-gas-pump"></i>BENZINA</div>
<div class="foot-btn" onclick="apriStorico()"><i class="fas fa-history"></i>STORICO</div>
<button class="btn-full" onclick="apriReport()">GENERA REPORT PDF</button>
<button class="btn-reset-soft" onclick="confirm('AZZERARE TUTTO?')&&(localStorage.clear(),location.reload())">AZZERA DATABASE</button>
</div>
<script>
let db=JSON.parse(localStorage.getItem('rider_db_final_v30'))||{turni:[],rifornimenti:[],targets:{},tax:20};const mesi=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];
function startClock(){setInterval(()=>{const e=new Date,t=e.toLocaleDateString('it-IT',{weekday:'long',day:'2-digit',month:'long',year:'numeric'}),a=e.toLocaleTimeString('it-IT');document.getElementById('liveDate').innerText=t,document.getElementById('liveClock').innerText=a},1e3)}
function salvaDB(){localStorage.setItem('rider_db_final_v30',JSON.stringify(db)),calcola()}
function chiudiModali(){document.querySelectorAll('.modal').forEach(e=>e.style.display='none')}
document.addEventListener('input',function(e){if("bP"===e.target.id){let t=e.target.value.replace(".","").replace(",","");t.length>=2&&(e.target.value=t.charAt(0)+"."+t.substring(1))}});
document.querySelectorAll('input').forEach(e=>{e.addEventListener('focus',function(){setTimeout(()=>{this.scrollIntoView({behavior:'smooth',block:'center'})},300)})});
function calcola(){const e=new Date,t=`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`;1===e.getDate()&&!sessionStorage.getItem('alertDone')&&(alert("⚠️ Mese terminato! Ricordati il report."),sessionStorage.setItem('alertDone','true'));let a=db.turni.filter(e=>e.data.includes(t)),r=db.rifornimenti.filter(e=>e.data.includes(t)),n=a.reduce((e,t)=>e+t.lordo,0),l=a.reduce((e,t)=>e+t.ore,0),o=a.reduce((e,t)=>e+t.km,0),i=a.reduce((e,t)=>e+t.km*(t.cons/100),0),s=r.reduce((e,t)=>e+t.euro,0),d=r.length>0?r[r.length-1].prezzo:1.85,c=n-(n*(db.tax/100))-i*d;document.getElementById('lordo').innerText=n.toFixed(2),document.getElementById('netto').innerText='€'+c.toFixed(2),document.getElementById('ore').innerText=l.toFixed(1),document.getElementById('cons').innerText=i.toFixed(1)+'L',document.getElementById('kml').innerText=i>0?(o/i).toFixed(1):'0.0',document.getElementById('spesaB').innerText='€'+s.toFixed(2);let g=db.targets[t]||0;document.getElementById('targetIn').value=g||"";document.getElementById('taxIn').value=db.tax;let m=g-n;document.getElementById('mancante').innerText='€'+(m>0?m.toFixed(2):"0.00");let u=g>0?Math.min(n/g*100,100):0;document.getElementById('perc').innerText=Math.round(u)+'%',document.getElementById('bar').style.width=u+'%'}
function apriStorico(){let e="";const t=[...db.turni.map(e=>({...e,tipo:'T'})),...db.rifornimenti.map(e=>({...e,tipo:'B'}))].sort((e,t)=>t.id-e.id);t.forEach(t=>{const a='T'===t.tipo,r=a?'var(--primary)':'var(--orange)';e+=`<div class="storico-item" style="border-left:4px solid ${r};border-right:4px solid ${r}"><div class="storico-info"><div class="tipo-label" style="color:${r}">${a?'TURNO':'BENZINA'}</div><div class="storico-data">${t.data} alle ${t.ora||'--:--'}</div><div class="storico-main" style="color:${r}">€${(a?t.lordo:t.euro).toFixed(2)}</div><div class="storico-sub">${a?t.km+'km | '+t.ore+'h | '+t.cons+'L/100':t.prezzo+'€/L | '+(t.euro/t.prezzo).toFixed(2)+'L'}</div></div><button onclick="elimina('${a?'turni':'rifornimenti'}',${t.id})" style="background:0 0;border:none;color:red;font-size:24px;padding-right:10px"><i class="fas fa-times-circle"></i></button></div>`}),document.getElementById('listaStorico').innerHTML=e||"Database vuoto",document.getElementById('histView').style.display='block'}
function apriReport(){const e=new Date,t=`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`;document.getElementById('repMonthTitle').innerText=`REPORT ${mesi[e.getMonth()].toUpperCase()} ${e.getFullYear()}`;let a="",r="",n=0,l=0,o=0,i=0,s=0;db.turni.filter(e=>e.data.includes(t)).sort((e,t)=>e.id-t.id).forEach(e=>{let t=e.km*(e.cons/100);n+=e.lordo,l+=e.ore,o+=e.km,i+=t,a+=`<tr><td>${e.data}</td><td>€${e.lordo.toFixed(2)}</td><td>${e.ore}h</td><td>${e.km}</td><td>${e.cons}</td><td>${t.toFixed(1)}L</td></tr>`}),db.rifornimenti.filter(e=>e.data.includes(t)).sort((e,t)=>e.id-t.id).forEach(e=>{s+=e.euro,r+=`<tr><td>${e.data}</td><td>€${e.euro.toFixed(2)}</td><td>€${e.prezzo.toFixed(3)}</td><td>${(e.euro/e.prezzo).toFixed(2)}L</td></tr>`}),document.getElementById('repTurniBody').innerHTML=a||"<tr><td colspan='6'>-</td></tr>",document.getElementById('repBenzaBody').innerHTML=r||"<tr><td colspan='4'>-</td></tr>";let d=n*(db.tax/100),c=db.rifornimenti.length>0?db.rifornimenti[db.rifornimenti.length-1].prezzo:1.85,g=i*c,m=l>0?(n/l).toFixed(2):0;document.getElementById('repFinalSummary').innerHTML=`<div class="summary-row"><span>LORDO TOTALE:</span><span>€${n.toFixed(2)}</span></div><div class="summary-row"><span>ORE TOTALI:</span><span>${l.toFixed(1)}h</span></div><div class="summary-row"><span>GUADAGNO ORARIO LORDO:</span><span>€${m}/ora</span></div><div class="summary-row"><span>KM TOTALI:</span><span>${o} km</span></div><div class="summary-row"><span>TASSE (${db.tax}%):</span><span>-€${d.toFixed(2)}</span></div><div class="summary-row"><span>SPESA BENZINA REALE:</span><span>€${s.toFixed(2)}</span></div><div class="summary-row"><span>CARBURANTE STIMATO:</span><span>-€${g.toFixed(2)}</span></div><div class="summary-row"><span>LITRI CONSUMATI:</span><span>${i.toFixed(2)} L</span></div><div class="summary-row total"><span>NETTO ESTIMATO MENSILE:</span><span>€${(n-d-g).toFixed(2)}</span></div>`,document.getElementById('reportView').style.display='block'}
function salvaTurno(){const e=`${document.getElementById('dateTD').value.padStart(2,"0")}/${document.getElementById('dateTM').value.padStart(2,"0")}/${document.getElementById('dateTY').value}`;db.turni.push({id:Date.now(),data:e,ora:(new Date).toLocaleTimeString().substring(0,5),lordo:parseFloat(document.getElementById('tL').value)||0,ore:parseFloat(document.getElementById('tO').value)||0,km:parseFloat(document.getElementById('tK').value)||0,cons:parseFloat(document.getElementById('tC').value)||0}),salvaDB(),chiudiModali()}
function salvaBenza(){const e=`${document.getElementById('dateBD').value.padStart(2,"0")}/${document.getElementById('dateBM').value.padStart(2,"0")}/${document.getElementById('dateBY').value}`;db.rifornimenti.push({id:Date.now(),data:e,ora:(new Date).toLocaleTimeString().substring(0,5),euro:parseFloat(document.getElementById('bE').value)||0,prezzo:parseFloat(document.getElementById('bP').value)||0}),salvaDB(),chiudiModali()}
function apriM(e){const t=new Date;let a="",r="",n="";for(let e=1;e<=31;e++)a+=`<option value="${e}" ${e==t.getDate()?"selected":""}>${e}</option>`;mesi.forEach((e,a)=>r+=`<option value="${a+1}" ${a==t.getMonth()?"selected":""}>${e.substring(0,3)}</option>`);for(let e=2025;e<=2030;e++)n+=`<option value="${e}" ${e==t.getFullYear()?"selected":""}>${e}</option>`;const l="modalTurno"===e?"dateT":"dateB";document.getElementById(l).innerHTML=`<select id="${l}D">${a}</select><select id="${l}M">${r}</select><select id="${l}Y">${n}</select>`,document.getElementById(e).style.display='flex'}
function aggiornaTarget(){const e=`${((new Date).getMonth()+1).toString().padStart(2,"0")}/${(new Date).getFullYear()}`;db.targets[e]=parseFloat(document.getElementById('targetIn').value)||0,salvaDB()}
function aggiornaTax(){db.tax=parseFloat(document.getElementById('taxIn').value)||20,salvaDB()}
function elimina(e,t){confirm("Eliminare?")&&(db[e]=db[e].filter(e=>e.id!==t),salvaDB(),apriStorico())}
window.onload=()=>{calcola(),startClock()};
</script>
</body>
</html>
