<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Rider Tracker Pro v95</title>

<style>
:root{--main:#00CCBC;--fuel:#ffa500;--bg:#0a0a0a;--card:#161616;--danger:#ff4444;--overlay:rgba(0,0,0,.9)}
body{background:var(--bg);color:#eee;font-family:sans-serif;margin:0;padding:5px;height:100vh;display:flex;flex-direction:column;overflow:hidden}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
.card{background:var(--card);padding:8px;border-radius:12px;border:1px solid #222;margin-bottom:5px}
.summary-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:4px}
.data-box{background:#1f1f1f;padding:5px;border-radius:8px;border:1px solid #333;text-align:center;min-height:45px;display:flex;flex-direction:column;justify-content:center}
.stat-label{font-size:7px;color:#888;text-transform:uppercase}
.stat-val{font-size:11px;font-weight:bold}
.progress-container{background:#111;height:22px;border-radius:6px;margin:8px 0;overflow:hidden;border:1px solid #333;position:relative}
.progress-bar{height:100%;width:0%;background:linear-gradient(90deg,#ff4444,#00d2ff,#2ecc71);transition:.5s}
.perc-text{position:absolute;width:100%;text-align:center;font-size:11px;font-weight:900;line-height:22px}
input,select{height:32px;background:#222;border:1px solid #444;color:#fff;border-radius:6px;font-size:12px;text-align:center;width:100%}
button{width:100%;border:none;border-radius:8px;font-weight:bold;height:38px}
#wrapperStorico{display:none;flex-grow:1;overflow-y:auto;background:#000;padding:10px 5px;border-radius:12px;border:1px solid #333}
.hist-item{background:#1a1a1a;padding:10px;border-radius:10px;margin-bottom:8px;border-left:4px solid var(--main);display:flex;justify-content:space-between}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:var(--overlay);z-index:100;justify-content:center;align-items:center}
.modal-content{background:#1c1c1e;padding:20px;border-radius:15px;border:1px solid var(--main);width:90%;max-width:300px}
.sticky-footer{margin-top:auto;padding-bottom:25px}
</style>
</head>

<body onload="init()">

<div class="card">
<div style="text-align:center;font-weight:900;color:var(--main)">üèéÔ∏è RIDER TRACKER PRO</div>

<div class="summary-grid">
<div class="data-box"><span class="stat-label">Lordo</span><span class="stat-val">‚Ç¨<span id="lordoTot">0</span></span></div>
<div class="data-box"><span class="stat-label">Netto</span><span class="stat-val" style="color:var(--main)">‚Ç¨<span id="netto">0</span></span></div>
<div class="data-box"><span class="stat-label">Ore</span><span id="oreTot" class="stat-val">0</span></div>
</div>

<div class="summary-grid">
<div class="data-box"><span class="stat-label">Consumo</span><span class="stat-val"><span id="litriStimati">0</span>L</span></div>
<div class="data-box"><span class="stat-label">KM/L</span><span id="kmLitro" class="stat-val">0</span></div>
<div class="data-box"><span class="stat-label">Benza</span><span class="stat-val" style="color:var(--danger)">‚Ç¨<span id="benzaTot">0</span></span></div>
</div>

<div class="summary-grid">
<div class="data-box"><span class="stat-label">Target</span><input id="targetIn" type="number" oninput="saveTarget()"></div>
<div class="data-box"><span class="stat-label">Manca</span><span class="stat-val">‚Ç¨<span id="manca">0</span></span></div>
<div class="data-box"><span class="stat-label">GG</span><span id="gg" class="stat-val">0</span></div>
</div>

<div class="progress-container">
<div class="perc-text" id="perc">0%</div>
<div class="progress-bar" id="bar"></div>
</div>
</div>

<div id="boxTurno" class="card">
<input id="tLordo" placeholder="Lordo ‚Ç¨">
<input id="tOre" placeholder="Ore">
<input id="tKm" placeholder="KM">
<input id="tExtra" placeholder="KM Extra">
<input id="tCons" placeholder="L/100km">
<button style="background:var(--main)" onclick="addTurno()">SALVA TURNO</button>
</div>

<div id="boxBenza" class="card">
<input id="bEuro" placeholder="‚Ç¨ spesi">
<input id="bPrezzo" placeholder="‚Ç¨/L">
<button style="background:var(--fuel)" onclick="addBenza()">SALVA BENZA</button>
</div>

<div id="wrapperStorico"><div id="storico"></div></div>

<div class="sticky-footer">
<button onclick="toggleStorico()">üìú STORICO</button>
<button style="background:#300;color:red" onclick="resetAll()">AZZERA</button>
</div>

<script>
let db=JSON.parse(localStorage.getItem("rider_db_v95"))||{turni:[],benza:[],target:0,fattore:0.8};

function init(){document.getElementById("targetIn").value=db.target;calc()}

function addTurno(){
db.turni.push({
l:+tLordo.value||0,
o:+tOre.value||0,
k:(+tKm.value||0)+(+tExtra.value||0),
c:+tCons.value||0,
d:new Date().toLocaleDateString()
});
[tLordo,tOre,tKm,tExtra,tCons].forEach(x=>x.value="");
calc()
}

function addBenza(){
db.benza.push({e:+bEuro.value||0,p:+bPrezzo.value||0});
[bEuro,bPrezzo].forEach(x=>x.value="");
calc()
}

function calc(){
let lordo=0,ore=0,km=0,litri=0;
db.turni.forEach(t=>{
lordo+=t.l;ore+=t.o;km+=t.k;
litri+=t.k*(t.c/100)
});
let benza=db.benza.reduce((s,b)=>s+b.e,0);
let netto=lordo*db.fattore-benza;
let p=db.target?Math.min(100,(netto/db.target)*100):0;

lordoTot.innerText=lordo.toFixed(2);
netto.innerText=netto.toFixed(2);
oreTot.innerText=ore.toFixed(1);
litriStimati.innerText=litri.toFixed(1);
kmLitro.innerText=litri? (km/litri).toFixed(1):"0";
benzaTot.innerText=benza.toFixed(2);
manca.innerText=Math.max(0,db.target-netto).toFixed(2);
gg.innerText=[...new Set(db.turni.map(t=>t.d))].length;
bar.style.width=p+"%";perc.innerText=Math.floor(p)+"%";

localStorage.setItem("rider_db_v95",JSON.stringify(db))
}

function saveTarget(){db.target=+targetIn.value||0;calc()}
function toggleStorico(){wrapperStorico.style.display=wrapperStorico.style.display?"":"block"}
function resetAll(){localStorage.removeItem("rider_db_v95");location.reload()}
</script>

</body>
</html>
