<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0e0f11">
<title>RIDER TRACKER PRO V1</title>
  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
:root{
  --bg:#0e0f11;
  --card:#181a1f;
  --primary:#00ccbc;
  --accent:#ff5e5e;
  --text:#f1f1f1;
  --muted:#8b8f97;
  --border:#2e323a;
  --input:#22252c;
  --glass:rgba(28,30,36,.75);
}

*{
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
}

body{
  margin:0;
  padding:12px;
  font-family:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,sans-serif;
  background:var(--bg);
  color:var(--text);
  position:fixed;
  inset:0;
  overflow:hidden;
}

h1{
  text-align:center;
  color:var(--primary);
  font-size:22px;
  letter-spacing:1px;
  margin:10px 0 18px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}

.box{
  background:var(--card);
  border-radius:16px;
  border:1px solid var(--border);
  height:78px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  box-shadow:0 6px 18px rgba(0,0,0,.35);
}

.label{
  font-size:9px;
  color:var(--muted);
  letter-spacing:1px;
  font-weight:800;
  margin-bottom:4px;
}

.value{
  font-size:14px;
  font-weight:800;
}

input{
  width:85%;
  background:var(--input);
  border:1px solid var(--border);
  border-radius:10px;
  padding:6px;
  color:white;
  text-align:center;
  font-size:13px;
}

.progressBox{
  margin-top:16px;
  background:var(--card);
  border-radius:20px;
  padding:16px;
  border:1px solid var(--border);
  box-shadow:0 10px 28px rgba(0,0,0,.45);
}

.progress{
  height:26px;
  background:#22252c;
  border-radius:13px;
  overflow:hidden;
}

#progress{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--primary),#baff00);
  transition:.3s;
}

.footer{
  position:fixed;
  left:12px;
  right:12px;
  bottom:12px;
  background:var(--glass);
  backdrop-filter:blur(14px);
  border-radius:26px;
  padding:16px;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
  border:1px solid var(--border);
}

.footer button{
  background:#1f232b;
  border:none;
  border-radius:18px;
  padding:14px 6px;
  color:white;
  font-size:11px;
  font-weight:800;
}

.footer i{
  display:block;
  font-size:22px;
  margin-bottom:6px;
  color:var(--primary);
}

.mainBtn{
  grid-column:span 3;
  background:var(--primary)!important;
  color:#000!important;
  font-weight:900;
  padding:18px;
}

.resetBtn{
  grid-column:span 3;
  background:#3a1212!important;
  color:#ffbcbc!important;
  font-size:11px;
}
</style>
</head>
<body>

<h1>RIDER TRACKER PRO</h1>

<div class="grid">
  <div class="box"><div class="label">Lordo</div><div class="value" id="lordo">0</div></div>
  <div class="box"><div class="label">Netto</div><div class="value" id="netto">0</div></div>
  <div class="box"><div class="label">Ore</div><div class="value" id="ore">0</div></div>

  <div class="box"><div class="label">Litri</div><div class="value" id="litri">0</div></div>
  <div class="box"><div class="label">Km/L</div><div class="value" id="kmL">0</div></div>
  <div class="box"><div class="label">Spesa</div><div class="value" id="spesa">0</div></div>

  <div class="box"><div class="label">Target</div><input id="target"></div>
  <div class="box"><div class="label">Tax %</div><input id="tax"></div>
  <div class="box"><div class="label">Mancante</div><div class="value" id="mancante">0</div></div>
</div>

<div class="progressBox">
  <div class="label" style="text-align:center;margin-bottom:8px">OBIETTIVO <span id="perc">0%</span></div>
  <div class="progress"><div id="progress"></div></div>
  <div id="clock" style="text-align:center;margin-top:8px;font-size:12px;color:var(--muted)"></div>
</div>

<div class="footer">
  <button onclick="apriTurno()"><i class="fa-solid fa-plus"></i>Turno</button>
  <button onclick="apriBenzina()"><i class="fa-solid fa-gas-pump"></i>Benzina</button>
  <button onclick="apriStorico()"><i class="fa-solid fa-clock-rotate-left"></i>Storico</button>
  <button class="mainBtn" onclick="generaReport()">Genera Report</button>
  <button class="resetBtn" onclick="resetDB()">Azzera Dati</button>
</div>

<script>
const dbKey="rider_tracker_db_v1";
let db=JSON.parse(localStorage.getItem(dbKey))||{turni:[],benzina:[],tax:20,target:0};

function salva(){localStorage.setItem(dbKey,JSON.stringify(db));calcola();}
function calcola(){
  let lordo=db.turni.reduce((a,b)=>a+b.lordo,0);
  let ore=db.turni.reduce((a,b)=>a+b.ore,0);
  let km=db.turni.reduce((a,b)=>a+b.km,0);
  let litri=db.turni.reduce((a,b)=>a+(b.km*b.cons/100),0);
  let spesa=db.benzina.reduce((a,b)=>a+b.euro,0);
  let netto=lordo-(lordo*(db.tax/100))-spesa;

  lordoEl.innerText=lordo.toFixed(2);
  nettoEl.innerText=netto.toFixed(2);
  oreEl.innerText=ore.toFixed(1);
  litriEl.innerText=litri.toFixed(1);
  kmLEl.innerText=litri? (km/litri).toFixed(1):"0";
  spesaEl.innerText=spesa.toFixed(2);

  let p=db.target?Math.min((netto/db.target)*100,100):0;
  perc.innerText=Math.round(p)+"%";
  progress.style.width=p+"%";
}

const lordoEl=lordo,nettoEl=netto,oreEl=ore,litriEl=litri,kmLEl=kmL,spesaEl=spesa;

function resetDB(){if(confirm("Azzerare tutto?")){localStorage.clear();location.reload();}}

setInterval(()=>clock.innerText=new Date().toLocaleString(),1000);
calcola();
</script>

</body>
</html>
